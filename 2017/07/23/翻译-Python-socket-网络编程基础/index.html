<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="linux | python | 爬虫 | 华为网络工程师 | HCNA | HCNP"><title>[翻译] Python socket - 网络编程教程 | Song F</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">[翻译] Python socket - 网络编程教程</h1><a id="logo" href="/.">Song F</a><p class="description">Liu's blog</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">[翻译] Python socket - 网络编程教程</h1><div class="post-meta">Jul 23, 2017<span> | </span><span class="category"><a href="/categories/Python/">Python</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="post-content"><h2 id="Pyhon-网络编程"><a href="#Pyhon-网络编程" class="headerlink" title="Pyhon 网络编程"></a>Pyhon 网络编程</h2><p>这是一篇 Python socket 编程的快速入门指南。Python socket 编程非常的类似于 C 语言。</p>
<p>首先，熟悉一下基础知识。</p>
<p>sockets（套接字）是你的计算机在进行任何类型的网络通信时所要做的最基本的“事情”。例如，当你在浏览器的地址栏中输入 www.google.com 时，计算机将与 google.com 服务器建立起一个 socket 连接，以用来获取所需要的页面并显示给你。而像 gtalk 或 skype 等这样的即时通讯软件的通信过程也是如此。任何一个网络通信都要通过套接字来连接。</p>
<p>在本教程中，我们将在 Python 中编写 TCP socket。</p>
<h3 id="开始之前"><a href="#开始之前" class="headerlink" title="开始之前"></a>开始之前</h3><p>本教程假设你已经具有了 Python 的基本知识。</p>
<h3 id="创建-socket"><a href="#创建-socket" class="headerlink" title="创建 socket"></a>创建 socket</h3><p>首先，使用函数 socket.socket 创建 socket。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Python socket 客户端示例</span></div><div class="line"><span class="keyword">import</span> socket  <span class="comment"># 导入 socket</span></div><div class="line"><span class="comment"># 创建一个 AF_INET, STREAM 的 TCP socket</span></div><div class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line"><span class="keyword">print</span> <span class="string">'Socket Created'</span></div></pre></td></tr></table></figure></p>
<p>函数 socket.socket 创建了一个 socket 并赋给了 s。我们可以在后续过程中调用 s。</p>
<p>上述代码会创建一个具有以下属性的 socket：</p>
<p>地址种类：AF_INET（代表使用 IPv4 地址）<br>socket 类型：SOCK_STREAM（代表创建一个 TCP socket）</p>
<h4 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h4><p>任何一个 socket 函数的创建失败，Python 都会抛出一个叫做 socket.error 的异常。而这个异常是可以被捕获的。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 处理 Python socket 程序中的错误</span></div><div class="line"><span class="keyword">import</span> socket   <span class="comment"># 导入 socket </span></div><div class="line"><span class="keyword">import</span> sys  <span class="comment"># 为了后面的退出</span></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line">    <span class="comment"># 创建一个 AF_INET, STREAM 的 TCP socket</span></div><div class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line"><span class="keyword">except</span> socket.error, msg:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Failed to create socket. Error code: '</span> + str(msg[<span class="number">0</span>]) + <span class="string">' ，Error message : '</span> + msg[<span class="number">1</span>]</div><div class="line">    sys.exit()</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket Created'</span></div></pre></td></tr></table></figure></p>
<p>好的，现在你已经成功创建了一个 socket。接下来，我们将尝试使用此 socket 连接到某些服务器。例如，我们可以连接到 www.google.com 。</p>
<h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><p>socket 除了 SOCK_STREAM 类型之外，还有一种 SOCK_DGRAM 类型，表示UDP协议。这种类型的套接字是面向无连接的过程。在本教程中，我们将只使用 SOCK_STREAM 类型的套接字。</p>
<h3 id="连接到服务器"><a href="#连接到服务器" class="headerlink" title="连接到服务器"></a>连接到服务器</h3><p>连接到服务器，我们需要两样东西，服务器的 IP 地址跟我们要连接的端口号。因此，我们需要通过某些手段获取要连接的远程服务器的 IP 地址。这里我们使用 google.com 的 IP 地址作为示例。（国内是连接不到的，原因你懂的）。</p>
<h4 id="获取远程服务器的-IP-地址"><a href="#获取远程服务器的-IP-地址" class="headerlink" title="获取远程服务器的 IP 地址"></a>获取远程服务器的 IP 地址</h4><p>在 Python 中获取远程主机 IP 地址非常简单。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> socket</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line">    <span class="comment"># 创建一个 AF_INET, STREAM 的 TCP socket</span></div><div class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line"><span class="keyword">except</span> socket.error, msg:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Failed to create socket. Error code: '</span> + str(msg[<span class="number">0</span>]) + <span class="string">' , Error message : '</span> + msg[<span class="number">1</span>]</div><div class="line">    sys.exit();</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">'Socket Created'</span></div><div class="line"></div><div class="line">host = <span class="string">'www.google.com'</span></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line">    remote_ip = socket.gethostbyname( host )</div><div class="line"></div><div class="line"><span class="keyword">except</span> socket.gaierror:</div><div class="line">    <span class="comment"># 无法解析</span></div><div class="line">    <span class="keyword">print</span> <span class="string">'Hostname could not be resolved. Exiting'</span></div><div class="line">    sys.exit()</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">'Ip address of '</span> + host + <span class="string">' is '</span> + remote_ip</div></pre></td></tr></table></figure></p>
<p>在获得了远程主机的 IP 地址之后，现在我们可以使用 connect 函数连接到该主机。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> socket</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line"><span class="keyword">try</span>:</div><div class="line">   <span class="comment"># 创建一个 AF_INET, STREAM 的 TCP socket</span></div><div class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line"><span class="keyword">except</span> socket.error, msg:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Failed to create socket. Error code: '</span> + str(msg[<span class="number">0</span>]) + <span class="string">' , Error message : '</span> + msg[<span class="number">1</span>]</div><div class="line">    sys.exit();</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket Created'</span></div><div class="line"> </div><div class="line">host = <span class="string">'www.google.com'</span></div><div class="line">port = <span class="number">80</span></div><div class="line"> </div><div class="line"><span class="keyword">try</span>:</div><div class="line">    remote_ip = socket.gethostbyname( host )</div><div class="line"> </div><div class="line"><span class="keyword">except</span> socket.gaierror:</div><div class="line">    <span class="comment"># 无法解析</span></div><div class="line">    <span class="keyword">print</span> <span class="string">'Hostname could not be resolved. Exiting'</span></div><div class="line">    sys.exit()</div><div class="line">     </div><div class="line"><span class="keyword">print</span> <span class="string">'Ip address of '</span> + host + <span class="string">' is '</span> + remote_ip</div><div class="line"> </div><div class="line"><span class="comment"># 连接到远程主机</span></div><div class="line">s.connect((remote_ip , port))</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket Connected to '</span> + host + <span class="string">' on ip '</span> + remote_ip</div></pre></td></tr></table></figure></p>
<p>运行程序<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> python client.py</div><div class="line">Socket Created</div><div class="line">Ip address of www.google.com is 74.125.236.83</div><div class="line">Socket Connected to www.google.com on ip 74.125.236.83</div></pre></td></tr></table></figure></p>
<p>上述程序先是创建了一个 socket 连接，后又连接到了远程主机。若是你尝试连接不是 80 的其他端口，程序应该是不能够建立连接的，这表示该端口未被打开。通过这样的方法，可以构建一个端口扫描器。</p>
<p>好，现在我们已经建立连接了。接下来让我们尝试发送一些数据到远程服务器。</p>
<h4 id="注意-1"><a href="#注意-1" class="headerlink" title="注意"></a>注意</h4><p><strong>“连接”</strong>的概念仅适用于 SOCK_STREAM / TCP 类型的套接字。连接，意味着数据有可靠<strong>“流”</strong>，而且数据可以有多个这样的流，每个流都有着它自己的通信链路。我们可以将“流”视为不受其他管道数据干扰的管道。流连接的另一个重要特性是数据包具有“顺序”或者说是“序列”。</p>
<p>UDP，ICMP，ARP等其他套接字没有“连接”的概念。这些是基于非连接的通信。每个连接都是不可靠的，接收者能不能接收到数据，全看网络的稳定性。即使接收不到，数据也不会重发。</p>
<p>（关于有连接的 TCP 与无连接的 UDP 的区别，详情请自行搜索）</p>
<h3 id="发送数据"><a href="#发送数据" class="headerlink" title="发送数据"></a>发送数据</h3><p>函数 sendall 将发送数据的这一过程简单化了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> socket</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line"><span class="keyword">try</span>:</div><div class="line">    <span class="comment"># 创建一个 AF_INET, STREAM 的 TCP socket</span></div><div class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line"><span class="keyword">except</span> socket.error, msg:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Failed to create socket. Error code: '</span> + str(msg[<span class="number">0</span>]) + <span class="string">' , Error message : '</span> + msg[<span class="number">1</span>]</div><div class="line">    sys.exit();</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket Created'</span></div><div class="line"> </div><div class="line">host = <span class="string">'www.google.com'</span></div><div class="line">port = <span class="number">80</span></div><div class="line"> </div><div class="line"><span class="keyword">try</span>:</div><div class="line">    remote_ip = socket.gethostbyname( host )</div><div class="line"> </div><div class="line"><span class="keyword">except</span> socket.gaierror:</div><div class="line">    <span class="comment"># 无法解析</span></div><div class="line">    <span class="keyword">print</span> <span class="string">'Hostname could not be resolved. Exiting'</span></div><div class="line">    sys.exit()</div><div class="line">     </div><div class="line"><span class="keyword">print</span> <span class="string">'Ip address of '</span> + host + <span class="string">' is '</span> + remote_ip</div><div class="line"> </div><div class="line"><span class="comment"># 连接到远程主机</span></div><div class="line">s.connect((remote_ip , port))</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket Connected to '</span> + host + <span class="string">' on ip '</span> + remote_ip</div><div class="line"> </div><div class="line"><span class="comment"># 发送数据到远程主机</span></div><div class="line">message = <span class="string">"GET / HTTP/1.1\r\n\r\n"</span></div><div class="line"> </div><div class="line"><span class="keyword">try</span> :</div><div class="line">    <span class="comment"># 发送整个字符串</span></div><div class="line">    s.sendall(message)</div><div class="line"><span class="keyword">except</span> socket.error:</div><div class="line">    <span class="comment"># 发送失败</span></div><div class="line">    <span class="keyword">print</span> <span class="string">'Send failed'</span></div><div class="line">    sys.exit()</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'Message send successfully'</span></div></pre></td></tr></table></figure>
<p>在上面的例子中，我们首先连接到了一个 IP 地址，然后向该地址发送了字符串消息 “GET / HTTP / 1.1 \ r \ n \ r \ n” 。该消息实际上是一个用来获取网站的主页的 <strong>“http命令”</strong> 。</p>
<p>既然已经成功发送了数据，那么就让我们来接收服务器返回的数据吧。</p>
<h3 id="接收数据"><a href="#接收数据" class="headerlink" title="接收数据"></a>接收数据</h3><p>函数 recv 用于接收数据。在以下示例中，我们将发送与上一个示例相同的消息，并从服务器接收回复。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Socket 客户端示例</span></div><div class="line"> </div><div class="line"><span class="keyword">import</span> socket</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line"><span class="comment"># 创建一个 AF_INET, SOCK_STREAM 属性的 socket</span></div><div class="line"><span class="keyword">try</span>:</div><div class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line"><span class="keyword">except</span> socket.error:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Failed to create socket'</span></div><div class="line">    sys.exit()</div><div class="line">     </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket Created'</span></div><div class="line"> </div><div class="line">host = <span class="string">'www.google.com'</span>;</div><div class="line">port = <span class="number">80</span>;</div><div class="line"> </div><div class="line"><span class="keyword">try</span>:</div><div class="line">    remote_ip = socket.gethostbyname( host )</div><div class="line"> </div><div class="line"><span class="keyword">except</span> socket.gaierror:</div><div class="line">    <span class="comment"># 无法解析</span></div><div class="line">    <span class="keyword">print</span> <span class="string">'Hostname could not be resolved. Exiting'</span></div><div class="line">    sys.exit()</div><div class="line"> </div><div class="line"><span class="comment"># 连接到远程主机</span></div><div class="line">s.connect((remote_ip , port))</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket Connected to '</span> + host + <span class="string">' on ip '</span> + remote_ip</div><div class="line"> </div><div class="line"><span class="comment"># 发送消息</span></div><div class="line">message = <span class="string">"GET / HTTP/1.1\r\n\r\n"</span></div><div class="line"> </div><div class="line"><span class="keyword">try</span> :</div><div class="line">    <span class="comment"># 发送整个字符串</span></div><div class="line">    s.sendall(message)</div><div class="line"><span class="keyword">except</span> socket.error:</div><div class="line">    <span class="comment"># 发送失败</span></div><div class="line">    <span class="keyword">print</span> <span class="string">'Send failed'</span></div><div class="line">    sys.exit()</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'Message send successfully'</span></div><div class="line"> </div><div class="line"><span class="comment"># 接收数据</span></div><div class="line">reply = s.recv(<span class="number">4096</span>)</div><div class="line"> </div><div class="line"><span class="keyword">print</span> reply</div></pre></td></tr></table></figure></p>
<p>这是上面代码的输出：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> python client.py</div><div class="line">Socket Created</div><div class="line">Ip address of www.google.com is 74.125.236.81</div><div class="line">Socket Connected to www.google.com on ip 74.125.236.81</div><div class="line">Message send successfully</div><div class="line">HTTP/1.1 302 Found</div><div class="line">Location: http://www.google.co.in/</div><div class="line">Cache-Control: private</div><div class="line">Content-Type: text/html; charset=UTF-8</div><div class="line">Set-Cookie: expires=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=www.google.com</div><div class="line">Set-Cookie: path=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=www.google.com</div><div class="line">Set-Cookie: domain=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=www.google.com</div><div class="line">Set-Cookie: expires=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=.www.google.com</div><div class="line">Set-Cookie: path=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=.www.google.com</div><div class="line">Set-Cookie: domain=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=.www.google.com</div><div class="line">Set-Cookie: expires=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=google.com</div><div class="line">Set-Cookie: path=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=google.com</div><div class="line">Set-Cookie: domain=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=google.com</div><div class="line">Set-Cookie: expires=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=.google.com</div><div class="line">Set-Cookie: path=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=.google.com</div><div class="line">Set-Cookie: domain=; expires=Mon, 01-Jan-1990 00:00:00 GMT; path=/; domain=.google.com</div><div class="line">Set-Cookie: PREF=ID=51f26964398d27b0:FF=0:TM=1343026094:LM=1343026094:S=pa0PqX9FCPvyhBHJ; expires=Wed, 23-Jul-2014 06:48:14 GMT; path=/; domain=.google.com</div></pre></td></tr></table></figure></p>
<p>Google.com 回复了我们所请求的页面。非常简单！ 现在我们已经接收到了回复，该把 socket 关闭了。</p>
<h4 id="关闭-socket"><a href="#关闭-socket" class="headerlink" title="关闭 socket"></a>关闭 socket</h4><p>函数 close 用于关闭 socket<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">s.close()</div></pre></td></tr></table></figure></p>
<h4 id="回顾总结"><a href="#回顾总结" class="headerlink" title="回顾总结"></a>回顾总结</h4><p>在上面的例子中我们学习了：</p>
<ol>
<li>创建一个 socket</li>
<li>连接远程主机</li>
<li>发送数据</li>
<li>接收回复</li>
</ol>
<p>当你在打开一个网页时，知道浏览器所做的 socket 连接的过程是很有用的。每一个 socket 连接都会连接到远程主机上获取信息，如同一个个<strong>客户端</strong>一样。</p>
<p>还有一种 socket 连接，称为<strong>服务器端</strong>。服务器是一种接收 socket 传入的信息并回复给他们想要的数据的系统。正好与客户端相反。所以 www.google.com 是一个服务器，而你的 Web 浏览器则是一个客户端。更详细一点就是，www.google.com 是一个 HTTP 服务器，你的 Web 浏览器是一个 HTTP 客户端。</p>
<h2 id="socket-服务器"><a href="#socket-服务器" class="headerlink" title="socket 服务器"></a>socket 服务器</h2><p>先来确认下服务器所需要做的事情：</p>
<ol>
<li>创建一个 socket</li>
<li>绑定到地址（和端口）</li>
<li>监听是否有连接传入</li>
<li>接收连接</li>
<li>接收/发送信息</li>
</ol>
<p>怎样打开创建 socket 我们已经学过了，接下来学习怎样绑定 IP 地址。</p>
<h3 id="绑定到-socket"><a href="#绑定到-socket" class="headerlink" title="绑定到 socket"></a>绑定到 socket</h3><p>函数 bind 用于将 socket 绑定到特定的地址和端口。它需要一个类似于 connect 函数的 ockaddr_in 结构（应该就是括号内还有一个括号的写法）。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> socket</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line">HOST = <span class="string">''</span>   <span class="comment"># 表示所有可用的地址</span></div><div class="line">PORT = <span class="number">8888</span> </div><div class="line"> </div><div class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line"><span class="keyword">print</span> <span class="string">'Socket created'</span></div><div class="line"> </div><div class="line"><span class="keyword">try</span>:</div><div class="line">    s.bind((HOST, PORT))</div><div class="line"><span class="keyword">except</span> socket.error , msg:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Bind failed. Error Code : '</span> + str(msg[<span class="number">0</span>]) + <span class="string">' Message '</span> + msg[<span class="number">1</span>]</div><div class="line">    sys.exit()</div><div class="line">     </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket bind complete'</span></div></pre></td></tr></table></figure></p>
<p>绑定完成之后，开始监听连接。我们将 socket 绑定到了特定的 IP 与特定的端口上，以确保可以接收到所有传入到此接口上的连接。</p>
<p>因而，我们是不能将两个 socket 绑定到同一个 IP 上。当然，凡事都有例外，具体在另外文章上有介绍。</p>
<h3 id="监听传入的连接"><a href="#监听传入的连接" class="headerlink" title="监听传入的连接"></a>监听传入的连接</h3><p>将 socket 绑定到 IP 地址之后，我们需要将 socket 置于监听模式，以监听传入的连接。函数socket_listen 用于将 socket 置于监听模式。绑定后添加以下行。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">s.listen(<span class="number">10</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">'Socket now listening'</span></div></pre></td></tr></table></figure></p>
<p>此函数的参数被称为 “积压”。它控制着可以同时建立的连接的数量，一旦超出这个数量，程序会处于“繁忙”状态，接下来传入的连接只能处于“等待”状态。上述例子中，将参数指定为 10，就是说如果已经有10个连接建立了，那么第11个将被拒绝，处于“等待”建立连接状态。</p>
<h3 id="接收传入的内容"><a href="#接收传入的内容" class="headerlink" title="接收传入的内容"></a>接收传入的内容</h3><p>函数 socket_accept 用于此功能。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> socket</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line">HOST = <span class="string">''</span></div><div class="line">PORT = <span class="number">8888</span></div><div class="line"> </div><div class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line"><span class="keyword">print</span> <span class="string">'Socket created'</span></div><div class="line"> </div><div class="line"><span class="keyword">try</span>:</div><div class="line">    s.bind((HOST, PORT))</div><div class="line"><span class="keyword">except</span> socket.error , msg:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Bind failed. Error Code : '</span> + str(msg[<span class="number">0</span>]) + <span class="string">' Message '</span> + msg[<span class="number">1</span>]</div><div class="line">    sys.exit()</div><div class="line">     </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket bind complete'</span></div><div class="line"> </div><div class="line">s.listen(<span class="number">10</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">'Socket now listening'</span></div><div class="line"> </div><div class="line"><span class="comment"># 等待接收连接</span></div><div class="line">conn, addr = s.accept()</div><div class="line"> </div><div class="line"><span class="comment"># 显示客户端信息</span></div><div class="line"><span class="keyword">print</span> <span class="string">'Connected with '</span> + addr[<span class="number">0</span>] + <span class="string">':'</span> + str(addr[<span class="number">1</span>])</div></pre></td></tr></table></figure></p>
<h4 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h4><p>运行程序，会输出：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> python server.py</div><div class="line">Socket created</div><div class="line">Socket bind complete</div><div class="line">Socket now listening</div></pre></td></tr></table></figure></p>
<p>现在，这个程序正在接收传入到 8888 端口的连接。请暂时不要关闭程序，以备接下来使用。</p>
<p>现在，通过 telnet 客户端我们可以连接到这个端口。打开终端，输入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> telnet localhost 8888</div></pre></td></tr></table></figure>
<p>它会立即显示：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> python server.py</div><div class="line">Socket created</div><div class="line">Socket bind complete</div><div class="line">Socket now listening</div><div class="line">Connected with 127.0.0.1:59954</div></pre></td></tr></table></figure></p>
<p>现在，通过 telnet 客户端，我们已经成功连接到了服务器程序。</p>
<p>但是，程序在接受了传入的连接之后，迅速的关闭了，这是不可以的。建立连接后，我们可以去做很多事情，例如，交流沟通。我们可以发送消息给客户端。</p>
<p>函数 sendall 可用于向传入的 socket 发送信息。在客户端就可以看到发送的内容。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> socket</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line">HOST = <span class="string">''</span></div><div class="line">PORT = <span class="number">8888</span></div><div class="line"> </div><div class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line"><span class="keyword">print</span> <span class="string">'Socket created'</span></div><div class="line"> </div><div class="line"><span class="keyword">try</span>:</div><div class="line">    s.bind((HOST, PORT))</div><div class="line"><span class="keyword">except</span> socket.error , msg:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Bind failed. Error Code : '</span> + str(msg[<span class="number">0</span>]) + <span class="string">' Message '</span> + msg[<span class="number">1</span>]</div><div class="line">    sys.exit()</div><div class="line">     </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket bind complete'</span></div><div class="line"> </div><div class="line">s.listen(<span class="number">10</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">'Socket now listening'</span></div><div class="line"> </div><div class="line">conn, addr = s.accept()</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'Connected with '</span> + addr[<span class="number">0</span>] + <span class="string">':'</span> + str(addr[<span class="number">1</span>])</div><div class="line"> </div><div class="line"><span class="comment"># 保持与客户端的连接</span></div><div class="line">data = conn.recv(<span class="number">1024</span>)</div><div class="line">conn.sendall(data)</div><div class="line"> </div><div class="line">conn.close()</div><div class="line">s.close()</div></pre></td></tr></table></figure>
<p>在一个终端内运行上述程序，然后在另一终端内用 telnet 连接到到此服务器，你将看到：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> telnet localhost 8888</div><div class="line">Trying 127.0.0.1...</div><div class="line">Connected to localhost.</div><div class="line">Escape character is '^]'.</div><div class="line">happy</div><div class="line">happy</div><div class="line">Connection closed by foreign host.</div></pre></td></tr></table></figure></p>
<p>客户端（telnet）已经收到了服务器的回复。而连接在此之后迅速关闭，这是因为程序已经运行完毕。</p>
<p>一个服务器，像谷歌这样的，总是不停的在接收连接。这就意味着服务器是在一直不停的运行着的。同样，我们也需要我们的程序一直不停的运行，最简单的方法就是将 <strong>accept</strong> 放在一个循环中。</p>
<h3 id="实时服务器"><a href="#实时服务器" class="headerlink" title="实时服务器"></a>实时服务器</h3><p>实时服务器是一直不停的在运行着。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> socket</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line">HOST = <span class="string">''</span></div><div class="line">PORT = <span class="number">5000</span></div><div class="line"> </div><div class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line"><span class="keyword">print</span> <span class="string">'Socket created'</span></div><div class="line"> </div><div class="line"><span class="keyword">try</span>:</div><div class="line">    s.bind((HOST, PORT))</div><div class="line"><span class="keyword">except</span> socket.error , msg:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Bind failed. Error Code : '</span> + str(msg[<span class="number">0</span>]) + <span class="string">' Message '</span> + msg[<span class="number">1</span>]</div><div class="line">    sys.exit()</div><div class="line">     </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket bind complete'</span></div><div class="line"> </div><div class="line">s.listen(<span class="number">10</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">'Socket now listening'</span></div><div class="line"> </div><div class="line"><span class="comment"># 保持与客户端的连接</span></div><div class="line"><span class="keyword">while</span> <span class="number">1</span>:</div><div class="line">    <span class="comment"># 等待传入连接</span></div><div class="line">    conn, addr = s.accept()</div><div class="line">    <span class="keyword">print</span> <span class="string">'Connected with '</span> + addr[<span class="number">0</span>] + <span class="string">':'</span> + str(addr[<span class="number">1</span>])</div><div class="line">     </div><div class="line">    data = conn.recv(<span class="number">1024</span>)</div><div class="line">    reply = <span class="string">'OK...'</span> + data</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data: </div><div class="line">        <span class="keyword">break</span></div><div class="line">     </div><div class="line">    conn.sendall(reply)</div><div class="line"> </div><div class="line">conn.close()</div><div class="line">s.close()</div></pre></td></tr></table></figure></p>
<p>上述代码只是将 socket_accept 放入了一个循环之中。</p>
<p>现在，在一个终端中运行此服务器程序，然后打开三个终端，各自使用 telnet 连接到该服务器。</p>
<p>每个终端都会收到这样的信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> telnet localhost 5000</div><div class="line">Trying 127.0.0.1...</div><div class="line">Connected to localhost.</div><div class="line">Escape character is '^]'.</div><div class="line">happy</div><div class="line">OK .. happy</div><div class="line">Connection closed by foreign host.</div></pre></td></tr></table></figure>
<p>而服务器所在终端则会显示：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> python server.py</div><div class="line">Socket created</div><div class="line">Socket bind complete</div><div class="line">Socket now listening</div><div class="line">Connected with 127.0.0.1:60225</div><div class="line">Connected with 127.0.0.1:60237</div><div class="line">Connected with 127.0.0.1:60239</div></pre></td></tr></table></figure></p>
<p>现在，服务器端一直在运行，与 telnet 客户端之间的连接也没有断开。如果关闭服务器，那么在 telnet 所在的终端就会显示 “Connection closed by foreign host”（外部主机关闭）。</p>
<p>实际上，服务器与客户端之间仍然没有可有效连接。服务器接收一个连接之后，只是向他们发送了一个回复，别的什么也没做。而且，服务器每次只能处理一个连接，不能同时处理多个。</p>
<p>接下来，让我们一一解决这些问题。</p>
<h3 id="处理连接"><a href="#处理连接" class="headerlink" title="处理连接"></a>处理连接</h3><p>为了处理连接，我们需要一段单独的程序与服务器主程序接收连接这个过程同时进行。为实现这一目的，我们可以使用线程（thread）这个方法。服务器的主程序接收一个传入的连接，创建一个线程去处理这个连接，而主程序则回到初始状态继续去接收连接。</p>
<p>我们将使用 threads 这一库去同时处理多个连接。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> socket</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">from</span> thread <span class="keyword">import</span> *</div><div class="line"> </div><div class="line">HOST = <span class="string">''</span></div><div class="line">PORT = <span class="number">8888</span></div><div class="line"> </div><div class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line"><span class="keyword">print</span> <span class="string">'Socket created'</span></div><div class="line"> </div><div class="line"><span class="keyword">try</span>:</div><div class="line">    s.bind((HOST, PORT))</div><div class="line"><span class="keyword">except</span> socket.error , msg:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Bind failed. Error Code : '</span> + str(msg[<span class="number">0</span>]) + <span class="string">' Message '</span> + msg[<span class="number">1</span>]</div><div class="line">    sys.exit()</div><div class="line">     </div><div class="line"><span class="keyword">print</span> <span class="string">'Socket bind complete'</span></div><div class="line"> </div><div class="line"><span class="comment"># 开始监听是否有连接传入</span></div><div class="line">s.listen(<span class="number">10</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">'Socket now listening'</span></div><div class="line"> </div><div class="line"><span class="comment"># 处理连接的函数，将被用来创建线程。</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">clientthread</span><span class="params">(conn)</span>:</span></div><div class="line">    <span class="comment"># 向每一个建立连接的客户端发送消息</span></div><div class="line">    conn.send(<span class="string">'Welcome to the server. Type something and hit enter\n'</span>) </div><div class="line">     </div><div class="line">    <span class="comment">#无限循环，使函数不终止，线程不结束。</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">         </div><div class="line">        <span class="comment"># 接收来自客户端的信息</span></div><div class="line">        data = conn.recv(<span class="number">1024</span>)</div><div class="line">        reply = <span class="string">'OK...'</span> + data</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data: </div><div class="line">            <span class="keyword">break</span></div><div class="line">     </div><div class="line">        conn.sendall(reply)</div><div class="line">     </div><div class="line">    <span class="comment"># 退出循环</span></div><div class="line">    conn.close()</div><div class="line"> </div><div class="line"><span class="comment"># 保持与客户端的连接</span></div><div class="line"><span class="keyword">while</span> <span class="number">1</span>:</div><div class="line">    <span class="comment">#wait to accept a connection - blocking call</span></div><div class="line">    conn, addr = s.accept()</div><div class="line">    <span class="keyword">print</span> <span class="string">'Connected with '</span> + addr[<span class="number">0</span>] + <span class="string">':'</span> + str(addr[<span class="number">1</span>])</div><div class="line">     </div><div class="line">    <span class="comment"># 启动新线程，第一个参数是要运行的函数名称，其次是要运行的函数的参数，必须是 tuple 类型。</span></div><div class="line">    start_new_thread(clientthread ,(conn,))</div><div class="line"> </div><div class="line">s.close()</div></pre></td></tr></table></figure>
<p>运行上面的服务器程序，像以前一样打开3个终端。现在，服务器将为连接到它的每个客户端创建一个线程。<br>telnet 终端将会显示：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> telnet localhost 8888</div><div class="line">Trying 127.0.0.1...</div><div class="line">Connected to localhost.</div><div class="line">Escape character is '^]'.</div><div class="line">Welcome to the server. Type something and hit enter</div><div class="line">hi</div><div class="line">OK...hi</div><div class="line">asd</div><div class="line">OK...asd</div><div class="line">cv</div><div class="line">OK...cv</div></pre></td></tr></table></figure></p>
<p>而服务器端会显示：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> python server.py</div><div class="line">Socket created</div><div class="line">Socket bind complete</div><div class="line">Socket now listening</div><div class="line">Connected with 127.0.0.1:60730</div><div class="line">Connected with 127.0.0.1:60731</div></pre></td></tr></table></figure></p>
<p>上述的连接处理程序，会从客户端接收输入，并以相同的方式回复。</p>
<h3 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h3><p>到目前为止，你必须已经学会了 Python 中套接字编程的基础知识。你可以尝试一些实验，如写聊天客户端或类似的东西。<br>测试代码时可能会遇到此错误<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Bind failed. Error Code : 98 Message Address already in use</div></pre></td></tr></table></figure></p>
<p>当出现上述问题的时候，只需要修改端口号即可。</p>
<p>原文地址：<a href="http://www.binarytides.com/python-socket-programming-tutorial/" target="_blank" rel="external">点此跳转</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://www.songf.win/2017/07/23/翻译-Python-socket-网络编程基础/" data-id="cj5nq0bfm0009wwwftpkiehi1" class="article-share-link">分享</a><div class="tags"><a href="/tags/翻译/">翻译</a><a href="/tags/Python/">Python</a><a href="/tags/socket/">socket</a></div><div class="post-nav"><a href="/2017/06/24/HCNA-笔记（二）：以太网/" class="next">HCNA 笔记（二）：以太网</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://www.songf.win"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/HCNA/">HCNA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/HCNA/" style="font-size: 15px;">HCNA</a> <a href="/tags/VRP/" style="font-size: 15px;">VRP</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/翻译/" style="font-size: 15px;">翻译</a> <a href="/tags/MongoDB/" style="font-size: 15px;">MongoDB</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/socket/" style="font-size: 15px;">socket</a> <a href="/tags/PhantomJS/" style="font-size: 15px;">PhantomJS</a> <a href="/tags/以太网/" style="font-size: 15px;">以太网</a> <a href="/tags/爬虫/" style="font-size: 15px;">爬虫</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/07/23/翻译-Python-socket-网络编程基础/">[翻译] Python socket - 网络编程教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/24/HCNA-笔记（二）：以太网/">HCNA 笔记（二）：以太网</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/17/CentOS-7-安装PhantomJS/">CentOS 7 安装PhantomJS</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/12/翻译-CentOS-7-安装-MongoDB/">[翻译] CentOS 7 安装 MongoDB</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/09/Python-爬虫（一）：抓取代理-IP/">Python 爬虫（一）：抓取代理 IP</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/08/HCNA-笔记（一）：VRP基础/">HCNA 笔记（一）：VRP基础</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">Song F.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>